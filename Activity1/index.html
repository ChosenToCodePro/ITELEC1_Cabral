<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This Diva</title>
    
</head>
<body style="font-family: Poppins serif;">
    <h1>i'm not getting paid enough</h1>
    <div class="controls">
        <select name="category" id="category">
            <option value="Any">All Categories</option>
            <option value="Programming">Programming</option>
            <option value="Misc">Misc</option>
            <option value="Puns">Puns</option>
            <option value="Spooky">Spooky</option>
            <option value="Christmas">Christmas</option>
        </select>
    </div>
    <button onclick="getTheThing()">Fire!</button>
    <div class="joke" id="something">Loading...</div>
    <div class="loader" id="loader" style="display:none;">Fetching Joke...</div>
    <script>
        const Jukebox = document.getElementById("something")
        const Loader = document.getElementById("loader")

        async function getTheThing() {
            Jukebox.textContent= ""
            Loader.style.display="block"
            const category = document.getElementById("category")

            try{
                const response = await fetch (`https://v2.jokeapi.dev/joke/${category.value}`)
                const data = await response.json()
                data.something = data.joke
                Loader.style.display="none"
                let jokeText=""

                if (data.type === "single"){
                    jokeText = data.something
                } else {
                    jokeText = `${data.setup} \n\n ${data.delivery}`
                }

                Jukebox.textContent = jokeText;
            } catch (error){
                Loader.style.display="none"
                Jukebox.textContent = "Oops, can't fetch buddy. try again soon!"
            }
        }
    </script>
</body>
</html>